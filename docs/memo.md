
# 3. Foilation

## 3.1. Idea and Background

非公式には、一次元の葉を持つ葉理とは、領域Mを不連続な曲線に分解したものである（図3左）[Moerdijk and Mrcun 2003 ˇ ]。つまり、同じトポロジーを持つ葉の間には1対1の連続的な対応がある。これにより、赤で描かれたMの断面上の低次元の射影写像と、（例えば区間[0, 1]への）個々の葉の一次元の射影写像から、Mと正方形の間の射影写像を作ることができる。区間の低次元写像は、葉の間の一対一の対応を確立する。すべての葉は不連続であり、対になった葉は互いに両対称に写像されるので、全体的な写像は両対称である。例えば、Mと（パンクチャーのある）単位円盤との間の射影写像は、円盤の正準極射影と位相的に等価な射影を用いて構成することができる（図4参照）。これは、点電荷場線写像[Gergen 1930; Xia et al. 2010a; Huynh and Gingold 2015]を一般化した形と見ることができる。
3次元では、葉の断面は2次元であるため、葉の対応関係を確立するためには2次元の断面写像が必要となる（この問題は再帰的に1次元のパラメトリゼーションに還元できる）。この断面写像を用いれば、2次元の場合と同様に、立方体や球への両対称写像を作ることができる。次に、我々のアルゴリズムの説明のために、より正確な定義を紹介する。

### 定義1

フォリエーションとは、多様体Mを一定の次元（ここでは1次元のみを考える）の不連続な低次元の部分多様体（リーフ）に分解したものである。

すなわち、葉は1次元で、それぞれが線分に同相である。つまり、閉じた葉や無限の葉は存在しない。葉が1次元で、それぞれが線分に同相であること、つまり、閉じた葉や無限の葉がないことである。 より一般的な葉形は、他の種類の領域にも有効である（そして、我々の手法の一部は、3次元以上の領域や、球以外の領域にも適用できる）。特異葉は、より低次元の特異葉を含むことができる。我々は、特異葉の1つのタイプのみを考える。それは、全ての葉の閉包にある1つの点特異点（中心）を持つ放射状の葉である。説明を簡単にするために、特異点のある小さな近傍領域（1つの正四面体か三角形）を取り除くことによって得られる領域の非特異点葉状化について考える。この縮小された領域を使って作られた写像は、除去された単峰に簡単に拡張される。1次元の葉を持つフォリエーションの横断面Sは、すべての葉とちょうど1回交差するn - 1次元の部分多様体である。例えば、図3と図4では、赤と緑の曲線が描かれた葉の断面である。各葉がt∈[0, 1]でパラメトリック化されると仮定すると、t = 0またはt = 1ですべての葉と交差する横断面は、それぞれソース部（赤い曲線）、シンク部（緑の曲線）と呼ばれる。

### 3.1.1. Maps from Foliations

ここでspはpを通る葉と交差する断面S上の点であり、tpはこの葉に沿ったpのパラメータである。Sと[0,1]n-1またはS n-1との間の両対称連続写像ψがわかっているとする。これらはそれぞれ、Dの正準直交または極交葉（図3と図4右の赤または緑）の断面である。Ψ(p)=(ψ(sp), tp)はMからD=[0, 1]nまたはD=S n-1 × [0,1]への射影写像である。この写像は、Mにそれぞれ直交座標または極座標を与え、単位正方形／立方体または円盤／球上のパラメトリゼーションを提供する。適切なt（例えば正規化された弧長）の選択により、Ψは連続となる。

### 3.1.2. PL Foliations and Direction Fields

PLフォリオと方向場。Mが三角形または四面体からなるn=2,3の次元の三角形分割された領域である場合、各単射内部の葉が平行な直線の線分である区分線形のフォリアシオンを考えるのが自然である。このような区分線形フォリアは、他のタイプよりも数値的にロバストな方法で扱うことができ、区分定数（PC）ベクトル場によって記述することができる： n-simplexの内部に割り当てられた定数ベクトルdiは、このsimplex内の平行な直線リーフセグメントの方向を指定する。
任意のPLフォリエーションはPC方向場を含意するが、逆は真ではない。Mのすべての点を通る一意な積分曲線が存在する場合にのみ、これらの区分線形曲線は葉を形成する（定義上、葉は不連続である）。一意な積分曲線のこの性質は、例えば一様リプシッツ連続ベクトル場のクラスではよく知られているが、問題のPC場のような不連続な場では一般に成立しない。積分曲線は（右図上に描かれているように）マージしたり分裂したりすることがあるが、フォリエーションの葉（下）とは異なる。この違いは非常に重要であり、PC場を直接パラメトリゼーションに使う際の主な障害の一つである。以下では、これらの場の組み合わせ論的条件を導出し、葉理への対応を保証する。各点を通る一意的な積分曲線を持つ一片定数場をフォリア対応と呼ぶ。

![pl](image-1.png)

## 3.2.  Generation Algorithm

我々は、領域境界での振る舞いや特異点の非存在に関する制約条件に従って、このようなフォリエーションに適合した方向場を構成する基本的なアルゴリズムを紹介する。セクション4.4では、その詳細な解析と議論を行う。ここでは、0≦k≦nのk-simplicesからなる、n＝2（三角形メッシュ）またはn＝3（四面体メッシュ）の単純メッシュMを考える。n-simplexcと入射(n-1)-simplex fに対して，cの外側を指すfの法線をncfとする．n-simplexが複数の境界(n-1)-simplexを持つことはないと仮定する．n-simplexは、それをMから取り除いて補体MĎに加えると、MとMĎの両方が多様体になる場合に自由である。特異な頂点または辺（その近傍がボールまたは半ボール位相幾何を持たない）がMまたはMĎに作られる場合はこの限りではない。このような自由な単項式が常に利用可能かどうかを問うことができる。セクション4.4で述べるように、そのための必要条件はメッシュが(bi)shellableであることであり、十分条件はメッシュが拡張可能に(bi)shellableであることである。2Dではこれはハードルではなく、3Dでは既知の反例がある。実用的な問題、特にcの選択とdcの選択に関する問題は後で具体化する。分析目的では、この抽象的なアルゴリズムで十分である。次に、なぜ結果の場が葉化適合であることが保証され、つまらない葉化を意味するのかについて述べる。第5節では、葉化適合体から陽的写像Ψ : M → Dとその逆写像を作る方法を説明する。

# 4. Foliation Compatibility Criteria

PC方位磁場が葉理を表すためには、磁場の局所的条件が満たされる必要がある。PC方向場が些細な葉理を表すためには、さらに大域的な条件が必要である。重要なことは、局所的条件も大域的条件も、純粋に離散方向場の組み合わせ論で定式化できることである。4.1 局所的条件 説明を簡単にするために、まず一般的な場を扱う。つまり、n-simplexの方向dは、内部のどの辺や面にも平行ではない。

## 4.1. Incoming and outgoing simplices

基本的な要件は、この点を通る場の積分曲線dが正確に1つ存在することである。点pを（その内部または境界に）含むn-simplex ci上の場の方向diと、pを方向diに通る直線の線分pをciに限定して考える。点 p を l から取り除くと、 l は方向 -di と di に対応する l- と l+ に分割される。定義2. (incomoming／outgoing n-simplex)半分の線分 l- が空でない場合，その単項式 ci をpに対してincoming（pに対してincomingの積分曲線を与える）と呼び， l+ が空でない場合，ci はpに対してoutgoingである．

### 定義2. (Incoming and outgoing n-simplex)

半分の区分 l- が空でないとき，pに対して入射する（pに対して入射する積分曲線を提供する）単項式を di と呼び， l+ が空でないとき，pに対して出射する単項式を di と呼ぶ．
右の例では，l-が赤，l+が緑： ci は p1 と p2 に対して入射，p2 と p3 に対して出射，p4 に対してどちらでもない．

![d2](image.png)

---

場の区分的定数の性質により、もしn-simplex cがk-simplex fの相対的内部にある点pに対して入射（出射）する場合、k＜nであれば、fの内部のすべての点に対して入射（出射）する。もしpがn-simplex cの内部に含まれるなら、この条件は自動的に満たされる： cはpに対して入射と出射を持つ。 k < nのk-simplexの相対的内部にある点pについては、その入射n-simplexを考える必要がある： n-単項式ciとcjに入射する(n-1)-単項式f上の点pに対しては、ciがp（等価的にf）に対して入射し、cjが出射すること、あるいはその逆を要求しなければならない。k＜n - 1のk-単項式では、入射するn-単項式が複数あるので、状況はより複雑になる。これらの観察から直ちに次の命題が導かれる：

---

### 命題1

一般的なPC方向場は、k＜nの各内部k-simplexが一意な入射n-simplexと一意な出射n-simplexを持ち、各境界k-simplexがせいぜい1つの入射n-simplexと1つの出射n-simplexを持つ場合にのみ、foliation-compatibleである。各境界k-simplexは最大で1つの入射n-simplexと1つの出射n-simplexを持つ。

---

### 双対グラフ

すなわち、M＊のn個のセルに対応する頂点と、（n-1）-simplexを共有するn個のセルを結ぶ辺を持つグラフである。各内部(n-1)シンプレックスfに対して、入射する2つのn-シンプレックスci とcj の一方が入射し、他方が出射するという条件は、ci とcj を結ぶ双対辺に向きを割り当てることによってモデル化できる2つの選択を可能にすることに注意してください。ci → cjは、ciがfに対して入射で、cjが出射であることを表す。各辺への向きの割り当てをOとすると、対応する有向双対辺グラフをG(M＊ , O)（略称：G）とする。

---

これは，(n-1)-simplex fでは，些細なことだが成り立つ：星は2つのn-simplexから成り，制限Gfは1つの有向辺（あるいは，境界では1つの頂点，これはソースとシンク）を持つ．より低次元の単純体（2次元では頂点、3次元では頂点と辺）では、Gの制限は（頂点に対して右図のように）両極である場合もあるし、そうでない場合もある。ここで、アルゴリズム1の出力が折れ線に適合することを証明するために用いる局所的な基準を定式化することができる。この条件は必要十分条件であり、すなわち、PC場の葉理適合性は完全に組合せ論的な事実である。ciが共通の(n-1)シンプレックスに対して入射し、cjが共通の(n-1)シンプレックスに対して出射する場合、ci → cjである。ciとcjがともに入射または出射の場合，対応する辺は無向のままである．部分配向グラフは決して局所的に双極にはならない。

![D3](image-2.png)

# 5. Evaluating Bijective Maps

一旦foliation-compatible field dが構築されれば、与えられた点p∈Mに対して、写像Ψを評価するためにそのfoliation座標を得ることができる。pが位置する葉lpがSと交わる点をspとし、lpに沿ったpのパラメータをtp∈[0, 1]とする。そして、tpをマイナー座標と呼び、断面点spの像ψ(sp)をメジャー座標と呼ぶ。直交座標または極座標として解釈すると、これらは写像Ψ(p)=(ψ(sp), tp)を定義する。これらの座標は、メッシュを通してPC方向場をトレースする比較的簡単なプロセスによって同時に決定されます。シンプレックスごとに一定の性質があるため、これはシンプレックスを通るd-平行投影のシーケンスに相当します。

## 5.1 Barycentric Field Representation

各ステップにおいて、アルゴリズム1はnsimplex ci上の方向diを選択しなければならない。すなわち、2Dの場合はu + v + w = 0となる(u, v, w)、3Dの場合はu + v + w + x = 0となる(u, v, w, x)である。これらの成分は、入射面（内向き）法線の係数として解釈できるので、それらの符号は、diと（n-1）シンプリックスの外向き法線ncfとのドット積の符号を直接決定する。したがって、与えられた入射／出射の構成に対して、di = (u, v, w) または (u, v, w, x) の成分の絶対値がゼロでないものを任意に選ぶことができる。なぜなら、固定された符号は、方向空間を入射／出射の制約を満たす方向だけにすでに制限しているからである。構造上、入射面と出射面は常に少なくとも1つずつ存在する。これは、両方の符号の成分が常に存在し、制約を満たす(u, v, w)と(u, v, w, x)の選択肢が常に存在することを意味する。このバリセントリック表現は便利であるだけでなく、以下に詳述するように、数値的にロバストな方法で後続のステップを簡単に実行できるようになります。

## 5.2 Leaf Tracing

ここでは3次元の場合を考える。2次元の場合（図6）は漸化式に従う。di=(u,v,w,x)である四面体ciのバリセントリック座標(α,β,γ,δ)で表される点pがあるとする。ciのpを通る（積分曲線の）支持線は、λ∈Rで、線方程式lp,ci (λ) = p - λdi = (α - λu, β - λv, γ - λw, δ -λx)で与えられる。ciの三角面の支持平面とlの交点は、これらの平面上で1つの重心座標成分が消失するという観察に基づいて簡単に決定される。

$l(\frac{\alpha}{u})=(0,\beta,\gamma,\delta)-\frac{\alpha}{u}(0,v,w,x)$

例えば、4つの交点のうちの1つは 4つの交点のうちのいくつかは（lが頂点または辺と交差する場合）等しいか、または（lが支持平面と交差するが面とは交差しない場合）正四面体の外側にある可能性があることに注意。この初歩的な操作によって，ある単峰から別の単峰へと区分線形積分曲線をなぞることができる．バリセントリック座標は局所的なので，次のn-simplexに渡るときには座標の変更が必要である．共通のk-simplex f上の点については、両方の入射n-simplexを基準とした重心座標は、fの頂点にのみ関係するので、この変換は、一方のn-simplexから他方のn-simplexへの局所頂点インデックスの変化に従って、単に重心座標を並べ替えることになる。

![LT](image-3.png)

(α, β, γ, δ): 四面体メッシュ内の特定の点を表すためのバリセントリック座標です。四面体メッシュ内の点を表すために使用され、各座標は対応する頂点に対する重みを表します。例えば、(α, β, γ, δ) は四面体の頂点の重み付き和で表される点を示します。

(u, v, w, x): 四面体メッシュ内の特定の方向を表すためのベクトルです。通常、このベクトルは特定の性質や方向を持つために使用されます。Leaf Tracingの文脈では、このベクトルが特定の方向を示すために使用され、点を通過する積分曲線の方向を定義するのに役立ちます。

l: 点 p を含む四面体内の積分曲線（integral curve）を表すための直線です。この直線は点 p を通過し、方向ベクトル d_i = (u, v, w, x) に沿って伸びます。積分曲線は、点 p から出発して特定の方向に延びる直線を表します。

α: バリセントリック座標系における点 p の重み付き和を表す変数です。点 p が四面体内のどの頂点にどの程度関連付けられているかを示します。バリセントリック座標系は、点を四面体の頂点に対する重み付き和として表現する方法です。

u: 方向ベクトル d_i = (u, v, w, x) の成分の1つであり、積分曲線の方向を定義するために使用されるベクトルの成分です。u 成分は積分曲線がどの方向に伸びるかを示します。

λ: 直線 l 上のパラメーターであり、積分曲線の位置を表すために使用されます。λ は直線 l 上を移動するためのパラメーターであり、特定の位置を示すために使用されます。

## 5.6. Numeric

セクション 3 では純粋に組み合わせアルゴリズムを扱いましたが、葉の追跡と主座標と副座標の決定には幾何学的な計算が含まれるため、数値の堅牢性の問題が生じます。 実数を使用した一般的な計算は、実際には正確に実行することはできず、さらには一貫して実行することさえできません [Yap 1997]。 しかし、有理数の分野では正確な計算が可能です。 いくつかのプログラミング言語にはこれをサポートする機能が組み込まれており、他のライブラリでは、従来の浮動小数点数を扱うのと同じくらい簡単に有理数を扱うことができます。 主に重心表現を使用しているため、このセクションに登場するリーフ トレースおよび座標計算の関数はすべて有理数であることに注意してください。 したがって、引数 p、d、h が有理であれば、結果も有理です。 したがって、p と d の成分が有理重心座標で与えられ、h が有理数値に設定されている場合、すべての計算は比数タイプを使用して正確に実行できます。 葉の真の弧長パラメータ化には h = |d| が必要ですが、これは一般に非合理的であることに注意してください。 ただし、h を |d| の有理近似に設定することはできます。 実際、h > 0 を選択すると、非弧長ではあるものの全単射の葉のパラメータ化が行われます。 h は n-simplex ごとに一定であり、トレース時に計算される h の割合 (セクション 5.4 を参照) は葉の間で連続的に変化するため、マップの連続性も影響を受けません。 有理極座標。 ただし、無理関数が関係する状況が 1 つあります。ディスク マップとボール マップの場合、極パラメータ化をデカルトパラメータ化に変換したい場合があります。 三角関数が関係しているため、これは有理数と無理数を関連付けます。 ただし、有理置換 sin∗ 、 cos∗ を使用して、極座標とデカルト座標の間の代替関係を効果的に定義できます。 唯一の要件は、(sin∗ θ, cos∗ θ) が (sin θ, cos θ) と同様に、ある区間 [a, b) とカット単位円の間の同相写像であることです。 これを達成するために、次のように sin∗ と cos∗ を有理関数 [−1, 3) → [−1, 1] として定義します。

$t_{\sin}(t)=\frac{2t}{1+t^2}, t_{\cos}(t)=\frac{1-t^2}{1+t^2}$

![Numeric](image-4.png)

## 6.X. Direction Field

一般的に、接線方向の曲率が小さい方向場dは、歪みの少ないマップにつながると予想される。シェリングオーダーが意味する制約の中で、我々は最も滑らかな方向フィールドを求める。この目的のために、最初に方向をその境界の重心に設定する（セクション5.1参照）。次に、ラプラシアン平滑化の数回の制約付きガウス・ザイデル反復を適用し、クランピングによって面の法線と場のドット積の正しい符号を維持する。さらに改善するために、このプロセスは、局所的なシェリング順序の変更と交互に行われる。ある反復において、(n-1)-simplex fijの両側への2つの方向di, djがfijに対してクランプされなければならなかった場合、シェリング順序は、Gの対応する双対辺の向きを反転することによって調整される（局所的かつ大域的な双極性が保たれている場合）。これにより、次の反復で場がさらに滑らかになる。図7は場の平滑化の効果を示している。

![DF](image-5.png)

# 7 Piecewise Linear Representation

セクション 5 では、全単射写像 Ψ を定義し、それが任意の点に対してどのように評価されるかを見ていきました。 さまざまな目的で、このようなマップの区分線形 (PL) 近似 ΨN は、単純なメッシュ N (おそらく M とは異なる) の頂点のマップ値によって完全に定義され、興味深いものになります。 この表現は依然として全単射的かつ連続的でなければなりません。つまり、PL ホーム不同型が求められます。 このような表現により、たとえば、入力が単射マップである場合に単射性を維持できる、さまざまなメッシュベースのマップ品質最適化手法の適用が可能になります [Schuller et al. 2013 ã ; ホーマンとグライナー、2000。 デゲナーら。 2003年; フーら。 2015年; ジンら。 2015年; リップマン 2012; ボムら。 2013]。 点ごとに定義された同型写像をサンプリングすることによってこの特性の近似を取得することは、多次元の場合には一般的な解決策がない難しい問題です [Groff 2003]。 ただし、前のセクションで定義したマップ Ψ は非常に特殊な構造を持っており、これを利用して、頂点のマップ値が PL 準同型性を定義するような単純なメッシュ N を考案できます (α+β +γ = 1)。 は、頂点 v0、v1、v2 を持つ三角形の p の重心座標です (3D の場合は同様に 4 つのコンポーネント)。 一般に M 自体はこの目的に適したメッシュではないことに注意してください。 洗練は避けられない可能性があります。 これは、私たちの特定の葉面ベースのアプローチの結果ではありません。セクション 2 で説明したように、特定の入力メッシュを PL 表現に直接使用することは不可能な場合があります。

$ΨN (p = αv0 + βv1 + γv2) := αΨ(v0) + βΨ(v1) + γΨ(v2),$

## 7.1. Initial Refinement

各三角形ciに、diに平行で、ciに実際にある3つの頂点の1つに入射する辺を追加する。その後、メッシュは不適合になる：頂点は三角形の辺に追加され、これらの頂点は、一般的に、反対側の三角形には組み込まれない。

## 7.2. Iterative Refinement

辺の1つに非連結頂点vを持つ三角形ciがある限り、diに平行にciを横切る辺を、vから始めてciの反対側の辺で終わるように加える。図8はこの処理の手順を示している。挿入された辺はMの頂点を通る葉を形成していることに注意。

出来上がったメッシュは三角形と四角形の面で構成される。対角線の辺を挿入することで、四辺形の面を三角形に分割する。得られた三角形メッシュはNと呼ばれ、次のような重要な性質を持つ：Nの同じ面内の任意の2点を通る2つの葉は、三角形の同じ列を通る。Nにおけるこれらの面の並びは、離散的な太い葉（図8右の破線の間を走る）として想像することができる。


```py
# 三角形メッシュの初期化
mesh = initialize_mesh()

# Initial Refinementの手順
def initial_refinement(mesh):
    new_vertices = []  # 新しい頂点を格納するリスト

    for triangle in mesh.triangles:
        # 三角形の各辺に平行な追加エッジを作成し、新しい頂点を追加
        for edge in triangle.edges:
            # エッジの中点を計算
            mid_point = calculate_midpoint(edge.start, edge.end)
            new_vertices.append(mid_point)

            # エッジに新しい頂点を追加
            edge.add_vertex(mid_point)

    # メッシュに新しい頂点を追加
    mesh.add_vertices(new_vertices)

# 中点を計算する関数（仮）
def calculate_midpoint(point1, point2):
    return Point((point1.x + point2.x) / 2, (point1.y + point2.y) / 2)

# メッシュの初期リファインメントを実行
initial_refinement(mesh)
```

7.1 PL Structure Extractionについて質問です．「Initial Refinement:」で語られていることについてよく理解できませんでした．あなたの解釈でいいので，Pythonの疑似コードを使ってこの操作を説明してみてもらえませんか？よろしくお願いします．

あなたが疑似コードを使って説明してくれたcalculate_midpoint関数はこの論文の通りの計算ですか？それともあなたの知識を使った仮のコードですか？私は怒っているではなく，本当に単純に分からないため聞いています．素直に事実に基づいて答えてください．よろしくお願いします．

ではコードを使っての説明ではなくてもいいので質問させてください．追加するエッジについて，この論文ではどのようなアルゴリズムに則って行われると述べられていますか？

では同様に7.1 PL Structure Extractionの「Iterative Refinement:」についても質問していいですか？こちらもPythonの疑似コードを使って説明してください．よろしくお願いします．

```py

# 三角形メッシュの初期化
mesh = initialize_mesh()

# Iterative Refinementの手順
def iterative_refinement(mesh):
    while not all_vertices_incorporated(mesh):
        for triangle in mesh.triangles:
            if not all_vertices_incorporated(triangle):
                # 三角形に含まれていない頂点を見つける
                non_incorporated_vertex = find_non_incorporated_vertex(triangle)
                
                # 非組み込み頂点を含むエッジに平行な新しいエッジを追加
                add_parallel_edge(triangle, non_incorporated_vertex)

# すべての頂点が組み込まれているかどうかをチェックする関数
def all_vertices_incorporated(element):
    return all(vertex.incorporated for vertex in element.vertices)

# 三角形内で組み込まれていない頂点を見つける関数
def find_non_incorporated_vertex(triangle):
    for vertex in triangle.vertices:
        if not vertex.incorporated:
            return vertex

# 非組み込み頂点を含むエッジに平行な新しいエッジを追加する関数
def add_parallel_edge(triangle, non_incorporated_vertex):
    # 新しいエッジを追加する処理を記述する

# メッシュのIterative Refinementを実行
iterative_refinement(mesh)

```

この疑似コードでは、与えられた三角形メッシュに対してIterative Refinementの手順を実行しています。各三角形内で組み込まれていない頂点を見つけ、その頂点を含むエッジに平行な新しいエッジを追加するという手順が繰り返し行われます。最終的に、すべての頂点が組み込まれるまでこのプロセスが続けられます。

「三角形に含まれていない頂点」とはどういったことでしょうか？これはどういった原因によって発生しますか？

初期メッシュの外側にメッシュ点が必要になるようなケース，つまり外挿はこの論文で想定されていますか？それは内挿と同じ式ですか？

つまり8章のresultの計算では，すべて初期メッシュをフィッティング対象よりも大きくとり，メッシュを内側に小さく変形させて合わせている，ということでしょうか？

具体的にそれはどこに書いてありますか？初期メッシュが対象よりも大きい，と書いている箇所についてです．

ではあなたは何を根拠に，「初期メッシュをフィッティング対象よりも大きく取り、そのメッシュを内側に小さく変形させて合わせる」と述べたのでしょうか？私は怒っているのではなく，純粋に分からないのです．論拠があればそれを示して欲しいです．よろしくお願いします．

ありがとうございます．では別の質問です．「elephant」や「 Monster」の形状にフィッティングしていますが，これは何を基準に計算しているのでしょうか．エッジ最外殻の境界を合わせ込む工程についてこの論文でどのように述べられていますか？

疲れてきていませんか？少し休みますか？

ありがとうございます．あなたの説明は大変分かりやすく理解できたのですが，やっぱり外殻の処理に関してはまだ分からないのです．内側の点の補完は分かるのですが，外殻はどうするのでしょうか？教えてもらえませんか？よろしくお願いします．
